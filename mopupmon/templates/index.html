{% extends "base.html" %}


{% block script %}
    <script>
        $(function(){
            $(document.body)
                .on('click', '.state_title', function(){
                    $(this).toggleClass('active')
                        .parent()
                        .find('.lgas')
                        .toggle();
                    return false;
                })
                .on('click', '.lga_row', function(){
                    var lga_id = $(this).data('lga_id');
                    $('#zones')
                        .data('scroll', document.body.scrollTop) // Save scroll position
                        .hide();
                    $('#' + lga_id).show();
                    document.body.scrollTop = 0;
                    return false;
                })
                .on('click', '.lga_details .back', function(){
                    $(this).closest('.lga_details').hide();
                    var scroll = $('#zones').show().data('scroll');
                    document.body.scrollTop = scroll;
                    return false;
                });
        });
    </script>
{% endblock %}


{% block content %}
    {% for zone in zones %}
        <div class="block_title">
            {{ zone["name"] }}
            <div class="percent_complete">
                {{ zone["percent_complete"] }}%
            </div>
        </div>
        {% for state in zone["states"] %}
            <div class="state">
                <div class="state_title">
                    {{ state["name"] }}
                    <div class="percent_complete">
                        {{ state["percent_complete"] }}%
                    </div>
                </div>
                <table class="lgas">
                    <tr>
                        <th class="lga_name"></th>
                        <th class="surveyed">Complete</th>
                        <th class="unsurveyed">Need to Survey</th>
                        <th class="complete"></th>
                    </tr>
                    {% for lga in state["lgas"] %}
                        <tr class="lga_row" data-lga_id="{{ lga["id"] }}">
                            <td class="lga_name">
                                {{ lga["name"] }}
                            </td>
                            <td>{{ len(lga["surveyed"]) }}</td>
                            <td>{{ len(lga["unsurveyed"]) }}</td>
                            <td>{{ lga["percent_complete"] }}%</td>
                        </tr>
                    {% endfor %}
                </table>
            </div>
        {% endfor %}
    {% endfor %}
{% endblock %}

