{% extends "base.html" %}


{% block head %}
  <link href="/static/leaflet/leaflet.css" media="all" rel="stylesheet" type="text/css">
{% endblock %}


{% block js %}
  <script src="/static/js/libs/backbone-min.js"></script>
  <script src="/static/leaflet/leaflet.js"></script>
  <script src="/static/leaflet/Google.js"></script>
  <script src="http://maps.google.com/maps/api/js?v=3&sensor=false"></script>
  <script src="/static/js/dashboard.js"></script>
  <script>
    NMIS.lgas = {};
    NMIS.indicators = {{ indicators|safe }};
    NMIS.lga_overview = {{ lga_overview|safe }};
    NMIS.lga_sectors = {{ lga_sectors|safe }};
  </script>
{% endblock %}


{% block nav_dashboard %}active{% endblock %}


{% block content %}
  <div id="lga_nav"></div>
  <div class="content"></div>

  <script id="lga_nav_template" type="text/html">
    <ul id="local-nav" class="nav">
      <li>
        <a href="#<%= lga.unique_lga %>/lga_<%= sector %>" >
          LGA Summary
        </a>
      </li>
      <li>
        <a href="#<%= lga.unique_lga %>/facility_<%= sector %>">
          Facility Detail
        </a>
      </li>
      <li class="small spacer">&nbsp;</li>
      <li>
        <a href="#<%= lga.unique_lga %>/<%= active_view %>_overview">
          Overview
        </a>
      </li>
      <li>
        <a href="#<%= lga.unique_lga %>/<%= active_view %>_health">
          Health
        </a>
      </li>
      <li>
        <a href="#<%= lga.unique_lga %>/<%= active_view %>_education">
          Education
        </a>
      </li>
      <li>
        <a href="#<%= lga.unique_lga %>/<%= active_view %>_water">
          Water
        </a>
      </li>
    </ul>
  </script>

  <script id="index_template" type="text/html">
    <div id="zone-navigation">
      <div class="page-header">
        <h1>Nigeria</h1>
      </div>
      <div class="zone-nav">
        <% _.each(zones, function(zone){ %>
          <div class="zl-wrap">
            <div class="zone-list">
              <h2 class="zone-title">
                <%= zone[0] %>
              </h2>
              <ul>
                <% _.each(zone[1], function(state){ %>
                  <li>
                    <a class="state-link">
                      <%= state[0] %>
                    </a>
                    <ul class="lga-list">
                      <% _.each(state[1], function(lga){ %>
                        <li>
                          <a href="#<%= lga[1] %>/lga_overview">
                            <%= lga[0] %>
                          </a>
                        </li>
                      <% }); %>
                    </ul>
                  </li>
                <% }); %>
              </ul>
            </div>
          </div>
        <% }); %>
        <div class="clearfix"></div>
      </div>
    </div>
  </script>
  <script id="lga_overview_template" type="text/html">
    <h2 class="some-lpadding">
      <%= lga.lga %>, <%= lga.state %> Overview
    </h2>
    <div class="row">
      <div class="profile-box">
        <div class="profile-box-inner">
          <table data-table-contents="lga-overview">
            <% _.each(NMIS.lga_overview.overview, function(indicator){ %>
              <tr>
                <td>
                  <%= NMIS.indicators[indicator].name %>
                </td>
                <td>
                  <%= format_value(lga[indicator]) %>
                </td>
              </tr>
            <% }); %>
          </table>
        </div>
        <div class="map"></div>
        </div>
    </div>
    <div class="row">
      <div class="span18 some-lpadding">
        <h2>
          LGA Overview
        </h2>
        <p style="font-style:italic;">
          Below are data from the baseline facility surveys.
        </p>
      </div>
    </div>
    <div class="row">
      <% _.each(NMIS.lga_overview.facility_overview, function(category){ %>
        <div class="span-one-third">
          <h3 class="mdg-underlined-title">
            <%= category.name %>
          </h3>
          <table class="mdg-table">
            <tbody>
              <% _.each(category.rows, function(indicator){ %>
                <tr>
                  <td>
                    <%= NMIS.indicators[indicator].name %>
                  </td>
                  <td>
                    <%= format_value(lga[indicator]) %>
                  </td>
                </tr>
              <% }); %>
            </tbody>
          </table>
        </div>
      <% }); %>
    </div>
    <div class="row">
      <div class="span18 some-lpadding">
        <h2>
          MDG Status
        </h2>
        <p style="font-style:italic;">
          Below are data collected from HNLSS, DHS, and other sources.
        </p>
      </div>
    </div>
    <div class="row">
      <div class="span18">
        <div id="mdg-table-wrap">
          <div class="mdg-tables">
            <table class="mdg-table">
              <% _.each(NMIS.lga_overview.mdg_status, function(mdg){ %>
                <tbody>
                  <tr>
                    <td class="mdg_header" colspan="5">
                      <%= mdg.header %>
                    </td>
                  </tr>
                  <% _.each(mdg.rows, function(indicator){ %>
                    <tr>
                      <td class="empty" colspan="2"></td>
                      <td>
                        <%= NMIS.indicators[indicator].name %>
                      </td>
                      <td class="data">
                        <%= format_value(lga[indicator]) %>
                      </td>
                    </tr>
                  <% }); %>
                </tbody>
              <% }); %>
            </table>
          </div>
        </div>
      </div>
    </div>
  </script>
  <script id="lga_sector_template" type="text/html">
    <h2 class="some-lpadding">
      <%= lga.lga %>, <%= lga.state %> <%= sector[0].toUpperCase() + sector.slice(1) %>
    </h2>
    <div class="nmis-sector-summary">
      <div class="non-gap">
        <table style="width:100%" class="mdg-table">
          <tbody>
            <% _.each(NMIS.lga_sectors[sector], function(section){ %>
              <tr>
                <th class="indheader mdg_header" colspan="2">
                  <%= section.name %>
                </th>
                <th class="indheader mdg_header flush-right">
                  Current
                </th>
              </tr>
              <% _.each(section.rows, function(indicator){ %>
                <% if (_.isString(indicator)) { %>
                  <tr>
                    <td class="empty-first empty bb"></td>
                    <td class="indicator-name bb">
                      <%= NMIS.indicators[indicator].name %>
                    </td>
                    <td class="indvalue bb">
                      <%= format_value(lga[indicator]) %>
                    </td>
                  </tr>
                <% } else { %>
                  <% var sub_section = indicator; %>
                  <tr>
                    <td class="empty-first empty bb"></td>
                    <td class="empty indheader mdg_header">
                      <%= sub_section.name %>
                    </td>
                  </tr>
                  <% _.each(sub_section.rows, function(indicator){ %>
                    <tr>
                      <td class="empty-first empty bb"></td>
                      <td class="indicator-name bb">
                        <%= NMIS.indicators[indicator].name %>
                      </td>
                      <td class="indvalue bb">
                        <%= format_value(lga[indicator]) %>
                      </td>
                    </tr>
                  <% }); %>
                <% } %>
              <% }); %>
            <% }); %>
          </tbody>
        </table>
      </div>
    </div>
  </script>
	<script id="facility_overview_template" type="text/html">
		<div class="container no-fill row" id="lga-widget-wrap">
			<div class="span9">
				<div class="row">
					<div class="span8 offset1">
						<h3>
							Facilities <span class="replace-counts">(<%= lga.facilities.length %>)</span>
						</h3>
					</div>
				</div>  
			</div>
			<div class="span8">
				<table class="simple-lines">
					<tbody>
						<tr>
							<td class="header" colspan="2">
								<%= lga.lga %>, <%= lga.state %>
							</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
	</script>
{% endblock %}


